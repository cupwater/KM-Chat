# MrDoc RAG 智能问答功能使用指南

## 当前状态

✅ **聊天功能**：正常工作，使用 DeepSeek Chat 模型  
⚠️ **嵌入模型**：DeepSeek 暂不支持，使用改进的回退算法  
✅ **向量检索**：使用回退算法进行文档相似度计算  
✅ **对话管理**：完整的会话历史管理功能  

## 快速开始

### 1. 访问智能问答页面

登录 MrDoc 后，访问：`http://your-domain/vector/chat/`

### 2. 开始对话

1. 点击"新对话"按钮
2. 在输入框中输入您的问题
3. 系统会自动检索相关文档并生成回答

### 3. 管理对话

- **查看历史**：左侧边栏显示所有对话
- **切换对话**：点击对话标题切换
- **删除对话**：点击对话右侧的删除按钮

## 功能特性

### 🎯 智能问答
- 基于文档内容回答问题
- 支持多轮对话
- 显示参考文档来源

### 📚 文档检索
- 语义相似度搜索
- 显示相似度分数
- 提供文档链接

### 💬 对话管理
- 保存对话历史
- 自动生成对话标题
- 支持删除对话

### 🎨 现代化界面
- 参考 Kimi 的设计风格
- 响应式布局
- 实时消息更新

## 技术说明

### 当前配置
- **聊天模型**：DeepSeek Chat
- **嵌入算法**：改进的哈希算法（回退方案）
- **向量数据库**：Milvus
- **向量维度**：1536

### 回退嵌入算法
由于 DeepSeek 暂不支持嵌入模型 API，系统使用改进的回退算法：

1. **字符频率分析**：分析文本中字符的出现频率
2. **文本长度特征**：考虑文本长度信息
3. **哈希值转换**：将文本哈希转换为数值向量
4. **向量归一化**：确保向量质量

### 性能特点
- ✅ 快速响应
- ✅ 内存占用低
- ✅ 无需额外 API 调用
- ⚠️ 语义理解能力有限

## 使用建议

### 1. 文档准备
- 确保文档内容清晰、结构化
- 使用描述性的文档标题
- 定期更新文档内容

### 2. 提问技巧
- 使用具体、明确的问题
- 避免过于宽泛的提问
- 可以追问以获得更详细的回答

### 3. 结果理解
- 查看参考文档了解信息来源
- 注意相似度分数（越高越相关）
- 可以点击文档链接查看原文

## 常见问题

### Q: 为什么没有使用真正的嵌入模型？
A: DeepSeek 目前不支持嵌入模型 API。系统使用改进的回退算法，在保证功能的同时提供良好的用户体验。

### Q: 回退算法的效果如何？
A: 回退算法基于文本特征和哈希值，能够进行基本的相似度计算。虽然不如专业嵌入模型精确，但对于大多数用例已经足够。

### Q: 如何提高检索效果？
A: 
- 使用更具体的文档标题
- 确保文档内容结构清晰
- 定期更新和维护文档

### Q: 支持哪些文档格式？
A: 系统基于 MrDoc 的文档系统，支持所有 MrDoc 支持的文档格式。

## 未来改进

### 计划功能
- [ ] 支持更多嵌入模型提供商
- [ ] 改进回退算法
- [ ] 添加文档预处理功能
- [ ] 支持多语言检索

### 性能优化
- [ ] 向量缓存机制
- [ ] 批量处理优化
- [ ] 查询结果排序改进

## 技术支持

如果遇到问题：

1. 检查 Milvus 服务是否正常运行
2. 确认 DeepSeek API 配置正确
3. 查看系统日志获取详细错误信息
4. 运行测试脚本验证功能

## 配置参考

```ini
[openai]
api_key = your-deepseek-api-key
base_url = https://api.deepseek.com/v1
model = deepseek-chat
max_tokens = 4000
temperature = 0.7

[milvus]
host = localhost
port = 19530
collection_name = mrdoc_documents
dimension = 1536
``` 